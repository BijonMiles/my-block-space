(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,a){e.exports=a.p+"static/media/standard-wallpaper.4bbd745f.jpg"},109:function(e,t,a){"use strict";a.d(t,"a",function(){return p});var n=a(16),s=a(17),r=a(19),c=a(18),o=a(20),l=a(0),i=a.n(l),u=a(591),m=a(592),d=a(572),p=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.person,a=e.username;return i.a.createElement(u.a,null,i.a.createElement(m.a,null,i.a.createElement(d.a,{xs:12,md:3,className:"myprofile-bio-wrap"},i.a.createElement("div",{className:"myprofile-bio"},i.a.createElement("div",{className:"bio-left"},i.a.createElement("img",{src:t.avatarUrl()?t.avatarUrl():"https://s3.amazonaws.com/onename/avatar-placeholder.png",className:"avatar",alt:"Avatar"})),i.a.createElement("span",{className:"heading-name"},t.name()?t.name():"Nameless Person"),i.a.createElement("br",null),i.a.createElement("span",{className:"display-username text-secondary"},a)))))}}]),t}(l.Component)},110:function(e,t,a){"use strict";a.d(t,"a",function(){return p});var n=a(16),s=a(17),r=a(19),c=a(18),o=a(20),l=a(0),i=a.n(l),u=a(592),m=a(572),d=a(593),p=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).parseDate=function(e){var t=a.state.now;return Math.floor((t-e)/6e4)<60?"".concat(Math.floor((t-e)/6e4)," m"):Math.floor((t-e)/36e5)<24?"".concat(Math.floor((t-e)/36e5)," h"):Math.floor((t-e)/864e5)<7?"".concat(Math.floor((t-e)/864e5)," d"):Math.floor((t-e)/864e5)<365?"".concat(Math.floor(Math.floor((t-e)/864e5)/7)," w"):void 0},a.showFulltext=function(){a.setState({fullText:!a.state.fullText})},a.state={now:Date.now(),fullText:!1},a}return Object(o.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.person,a=e.username,n=e.status;return i.a.createElement("div",{className:"my-post"},i.a.createElement(u.a,{className:"poster-info-con"},i.a.createElement(m.a,{xs:2},i.a.createElement(d.a,{className:"post-link",to:"/users/".concat(a)},i.a.createElement("img",{src:t.avatarUrl()?t.avatarUrl():"https://s3.amazonaws.com/onename/avatar-placeholder.png",alt:"",className:"post-img"}))),i.a.createElement(m.a,{xs:3,className:"poster-info"},i.a.createElement(d.a,{className:"post-link",to:"/users/".concat(a)},a)),i.a.createElement(m.a,{xs:4}),i.a.createElement(m.a,{xs:3},i.a.createElement("span",{className:"post-date"},"".concat(this.parseDate(n.created_at)," ago")))),i.a.createElement("hr",null),n.image&&i.a.createElement("div",{className:"post-pic-container"},i.a.createElement("img",{alt:"",className:"post-pic",src:n.image}),i.a.createElement("hr",null)),!this.state.fullText&&(n.text.length>500?i.a.createElement("pre",null,n.text.substring(0,500),"...",i.a.createElement("br",null),i.a.createElement("strong",{className:"show-more",onClick:this.showFulltext},"show more")):i.a.createElement("pre",null,n.text)),this.state.fullText&&i.a.createElement("pre",null,n.text," ",i.a.createElement("br",null),i.a.createElement("strong",{className:"show-more",onClick:this.showFulltext},"show less")))}}]),t}(l.Component)},169:function(e,t,a){e.exports=a.p+"static/media/free-speech-icon.417703c9.svg"},170:function(e,t,a){e.exports=a.p+"static/media/privacy-icon.bb33b0ed.svg"},171:function(e,t,a){e.exports=a.p+"static/media/tracking-icon.2f9daf47.svg"},265:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return D});var n=a(40),s=a.n(n),r=a(68),c=a(16),o=a(17),l=a(19),i=a(18),u=a(20),m=a(31),d=a(0),p=a.n(d),h=a(11),f=a(592),g=a(572),E=a(85),v=a(594),b=a(119),w=a(595),y=a(575),N=a(108),O=a.n(N),j=a(266),S=a.n(j),k=a(267),x=a.n(k),I=a(268),F=a.n(I),C=a(109),P=a(69),D=function(t){function a(t){var n;return Object(c.a)(this,a),(n=Object(l.a)(this,Object(i.a)(a).call(this,t))).isLocal=function(){return n.props.match.params.username===Object(h.loadUserData)().username},n.fetchData=function(){var e,t,a={};Object(h.getFile)("postids.json",{decrypt:!1}).then(function(t){if((e=JSON.parse(t||"[]")).length>0)for(var s=0;s<e.length;s++)a["".concat(e[s])]=n.props.username}).then(Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchSettings();case 2:t=e.sent;case 3:case"end":return e.stop()}},e,this)}))).catch(function(){console.log("oepsie, could not fetch data")}).finally(function(){n.setState({isLoading:!1,postIds:e,postIdAndName:a,settings:t})})},n.fetchSettings=function(){return Object(h.getFile)("settings.json",{decrypt:!1}).then(function(e){var t=JSON.parse(e||!1);return t||n.state.settings})},n.captureFile=function(t){t.preventDefault();var a=t.target.files[0],s=new window.FileReader;s.readAsArrayBuffer(a),s.onloadend=function(){n.setState({newImage:"data:image/jpeg;base64,".concat(e(s.result).toString("base64"))})}},n.captureFileBackground=function(t){t.preventDefault();var a=t.target.files[0],s=new window.FileReader;s.readAsArrayBuffer(a),s.onloadend=function(){n.setState({settings:{backgroundImage:"data:image/jpeg;base64,".concat(e(s.result).toString("base64"))}})}},n.defaultBackground=function(e){e.preventDefault(),n.setState({settings:{backgroundImage:!1}})},n.deleteImage=function(){n.setState({newImage:!1})},n.logUserInfo=function(){console.log(Object(h.loadUserData)())},n.toggleSettings=function(){n.setState({changeInfo:!n.state.changeInfo})},n.saveSettings=function(){var e=n.state.settings;Object(h.putFile)("settings.json",JSON.stringify(e),{encrypt:!1}).then(function(){n.setState({changeInfo:!1})})},n.displayFriends=function(){n.setState({displayFriends:!n.state.displayFriends})},n.state={checked:!1,newStatus:"",isLoading:!0,changeInfo:!1,newImage:!1,settings:{backgroundImage:!1,image:!1,bio:!1,displayName:!1},displayFriends:!1,posts:{},postIds:[],postIdAndName:{}},n.handleNewStatusChange=n.handleNewStatusChange.bind(Object(m.a)(Object(m.a)(n))),n.handleNewStatusSubmit=n.handleNewStatusSubmit.bind(Object(m.a)(Object(m.a)(n))),n.saveNewStatus=n.saveNewStatus.bind(Object(m.a)(Object(m.a)(n))),n}return Object(u.a)(a,t),Object(o.a)(a,[{key:"saveNewStatus",value:function(){var e=this,t=this.state.postIds,a=this.state.posts,n=this.state.newStatus.trim();if(0===n.length)return!1;var s=Date.now(),r=t.length,c={id:r++,text:n,created_at:s,image:this.state.newImage};t.unshift(s);var o={encrypt:!1};Object(h.putFile)("post".concat(s,".json"),JSON.stringify(c),o).then(function(){Object(h.putFile)("postids.json",JSON.stringify(t),o).then(function(){e.setState({postIds:t,posts:a}),e.fetchData()}).catch(function(){console.log("something went wrong with saving your post id")})}).catch(function(){console.log("something went wrong with saving your post")})}},{key:"handleNewStatusChange",value:function(e){this.setState({newStatus:e.target.value})}},{key:"handleNewStatusSubmit",value:function(e){this.saveNewStatus(),this.setState({newStatus:"",newImage:!1})}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this,t=this.props,a=t.person,n=t.username,s={backgroundImage:'url("'.concat(this.state.settings.backgroundImage?this.state.settings.backgroundImage:O.a,'"')},r=p.a.createElement("div",{className:"new-status settings"},p.a.createElement(f.a,null,p.a.createElement(g.a,{md:12},p.a.createElement(E.a,null,p.a.createElement(E.a.Group,{as:f.a,controlId:"formPlaintextEmail"},p.a.createElement(E.a.Label,{column:!0,sm:"12"},"To change the display name, image and bio press ",p.a.createElement("a",{target:"_blank",href:"https://browser.blockstack.org/profiles",rel:"noopener noreferrer"},"here"),".")),p.a.createElement(E.a.Group,{as:f.a,controlId:"formPlaintextPassword"},p.a.createElement(E.a.Label,{column:!0,sm:"3"},"Background image"),p.a.createElement(g.a,{sm:"9"},p.a.createElement("label",{className:"btn btn-outline-success"},"Upload ",p.a.createElement("input",{type:"file",onChange:this.captureFileBackground,hidden:!0})),"     ",p.a.createElement("label",{className:"btn btn-outline-danger",onClick:this.defaultBackground},"Default"))),p.a.createElement("hr",null),p.a.createElement(v.a,{variant:"success",onClick:this.saveSettings},"Save"))))),c=this.props.friends.length>0?p.a.createElement("div",{className:"profile-posts"},p.a.createElement("div",{className:"my-post"},p.a.createElement("h1",null,"Friends"),p.a.createElement(b.a,{variant:"flush"},this.props.friends.map(function(t){return p.a.createElement("div",{className:"my-friend",key:t},p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:12},p.a.createElement(b.a.Item,{onClick:function(){e.props.searchFor(t)}},t))))})))):p.a.createElement("div",{className:"profile-posts"},p.a.createElement("div",{className:"my-post"},p.a.createElement("h1",null,"Friends"),p.a.createElement(b.a,{variant:"flush"},p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:12},p.a.createElement(b.a.Item,null,"You don't have any friends yet."))))));return p.a.createElement("div",null,a&&p.a.createElement("div",{className:"container-myprofile"},p.a.createElement("div",{className:"container-desc-prof"},p.a.createElement("div",{style:s,className:"background-image"}),p.a.createElement(C.a,{person:a,username:n}),p.a.createElement("div",{className:"myprofile-options"},p.a.createElement(f.a,{className:"my-options"},p.a.createElement(g.a,{xs:3}),p.a.createElement(g.a,{xs:1},p.a.createElement("img",{src:S.a,onClick:this.toggleSettings,alt:"",className:"bio-icons"})),p.a.createElement(g.a,{xs:8},p.a.createElement("img",{src:F.a,onClick:this.displayFriends,alt:"",className:"bio-icons"}))),p.a.createElement(f.a,null,p.a.createElement(g.a,{md:3}),p.a.createElement(g.a,{xs:12,md:8},p.a.createElement("hr",null)," "),p.a.createElement(g.a,{md:1})),p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:12},p.a.createElement("p",{className:"text-secondary"},a.description()?a.description():"You have no bio."))))),this.state.displayFriends&&c,!this.state.displayFriends&&p.a.createElement("div",{className:"profile-posts"},p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:1,md:1,xl:2}),p.a.createElement(g.a,{sm:12,md:10,xl:8},this.isLocal()&&p.a.createElement("div",null,this.state.changeInfo&&r,p.a.createElement("div",{className:"new-status"},p.a.createElement(f.a,null,p.a.createElement(g.a,{md:12},this.state.newImage&&p.a.createElement("div",{className:"post-pic-container"},p.a.createElement(v.a,{onClick:this.deleteImage,variant:"outline-danger",className:"delete-img"},"X"),p.a.createElement("img",{alt:"",className:"post-pic",als:"",src:this.state.newImage})),p.a.createElement(w.a,null,p.a.createElement(y.a,{as:"textarea",className:"input-status",value:this.state.newStatus,onChange:function(t){return e.handleNewStatusChange(t)},placeholder:"What's on your mind?"})))),p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:2,className:"input-btn-wrapper"},p.a.createElement("label",{className:"btn btn-outline-secondary"},p.a.createElement("img",{alt:"",src:x.a})," ",p.a.createElement("input",{type:"file",onChange:this.captureFile,hidden:!0}))),p.a.createElement(g.a,{xs:6}),p.a.createElement(g.a,{xs:4,className:" input-btn-wrapper"},p.a.createElement(v.a,{variant:"outline-success",className:"",onClick:function(t){return e.handleNewStatusSubmit(t)}},"POST")))))),p.a.createElement(g.a,{xs:1,md:1})),p.a.createElement(f.a,null,p.a.createElement(g.a,{xs:1,md:1,xl:2}),p.a.createElement(g.a,{sm:12,md:10,xl:8},p.a.createElement(P.a,{array:!1,order:this.state.postIds,allPosts:this.state.posts,postIdAndName:this.state.postIdAndName,person:a,username:n})),p.a.createElement(g.a,{xs:1,md:1})))))}}]),a}(d.Component)}).call(this,a(2).Buffer)},266:function(e,t,a){e.exports=a.p+"static/media/settings.674d9d35.svg"},267:function(e,t,a){e.exports=a.p+"static/media/camera.8b7b6457.svg"},268:function(e,t,a){e.exports=a.p+"static/media/users.937fec69.svg"},271:function(e,t,a){e.exports=a.p+"static/media/2.1c89fea0.png"},272:function(e,t,a){e.exports=a.p+"static/media/3.c14b3b5d.png"},276:function(e,t,a){e.exports=a(590)},281:function(e,t,a){},295:function(e,t){},296:function(e,t){},317:function(e,t){},319:function(e,t){},524:function(e,t){},587:function(e,t,a){},590:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(167),c=a.n(r),o=(a(281),a(40)),l=a.n(o),i=a(68),u=a(16),m=a(17),d=a(19),p=a(18),h=a(20),f=a(265),g=a(594),E=a(591),v=a(592),b=a(572),w=a(271),y=a.n(w),N=a(169),O=a.n(N),j=a(170),S=a.n(j),k=a(171),x=a.n(k),I=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.handleSignIn;return s.a.createElement("div",{className:"panel-landing"},s.a.createElement("div",{className:"landing-container"},s.a.createElement("div",{className:"landing-logo-container"},s.a.createElement("img",{className:"landing-logo",src:y.a,alt:"logo"})),s.a.createElement("h1",null,"The Decentralized Social Network"),s.a.createElement("p",null,"Create, Follow, and Share. You always decide with who. ")),s.a.createElement("div",{className:"landing-square-container"},s.a.createElement("div",{className:"square-container"},s.a.createElement("div",{className:"landing-square-text"},s.a.createElement(g.a,{className:"signin-button",onClick:e.bind(this)},"Sign In with Blockstack")),s.a.createElement("div",{className:"landing-square"}))),s.a.createElement("div",{className:"card-container-back"},s.a.createElement(E.a,{className:"card-container"},s.a.createElement(v.a,null,s.a.createElement(b.a,{md:12,lg:4},s.a.createElement("div",{className:"flip-card"},s.a.createElement("div",{className:"flip-card-inner"},s.a.createElement("div",{className:"flip-card-front"},s.a.createElement("img",{src:O.a,alt:"free speech icon"}),s.a.createElement("span",null,"Free Speech")),s.a.createElement("div",{className:"flip-card-back"},s.a.createElement("img",{src:O.a,alt:"free speech icon"}),s.a.createElement("hr",null),s.a.createElement("p",null,"Take a stand against government surveillance or companies using your social media data without your consent. You decide what you share and with who you share it."))))),s.a.createElement(b.a,{md:12,lg:4},s.a.createElement("div",{className:"flip-card"},s.a.createElement("div",{className:"flip-card-inner"},s.a.createElement("div",{className:"flip-card-front"},s.a.createElement("img",{src:S.a,alt:"privacy-icon"}),s.a.createElement("span",null,"You own your data")),s.a.createElement("div",{className:"flip-card-back"},s.a.createElement("img",{src:S.a,alt:"privacy-icon"}),s.a.createElement("hr",null),s.a.createElement("p",null,"We use Blockstack\u2019s decentralized identity and storage system, giving you total ownership of your data. You control who can access your data, not us."))))),s.a.createElement(b.a,{md:12,lg:4},s.a.createElement("div",{className:"flip-card"},s.a.createElement("div",{className:"flip-card-inner"},s.a.createElement("div",{className:"flip-card-front"},s.a.createElement("img",{src:x.a,alt:"no tracking icon"}),s.a.createElement("span",null,"No tracking")),s.a.createElement("div",{className:"flip-card-back"},s.a.createElement("img",{src:x.a,alt:"no tracking icon"}),s.a.createElement("hr",null),s.a.createElement("p",null,"My Block Space is an open source project created by the community for the community. The goal is to make an easy to use social platform for free where the user is ",s.a.createElement("strong",null,"not")," the product.")))))))))}}]),t}(n.Component),F=a(596),C=a(597),P=a(595),D=a(575),L=a(11),M=a(593),U=a(272),A=a.n(U),T=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this))).handleSignOut=function(e){e.preventDefault(),Object(L.signUserOut)(window.location.origin)},e.handleKeyPress=function(t){t.preventDefault();var a=e.state.searchUser.trim();e.props.searchFor(a)},e.handleChange=function(t){t.preventDefault(),e.setState({searchUser:t.target.value})},e.state={searchUser:void 0},e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.person,n=t.username;return s.a.createElement("div",null,s.a.createElement(F.a,{bg:"light",collapseOnSelect:!0,fixed:"top",expand:"sm",className:"navbar-con"},s.a.createElement(F.a.Brand,null,s.a.createElement(M.a,{className:"nav-home-link",to:"/feed"},s.a.createElement("img",{src:A.a,width:"30",height:"30",className:"d-inline-block align-top logo-nav",alt:"MY BLOCK SPACE"}))),s.a.createElement(F.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(F.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(C.a,{className:"mr-auto"},s.a.createElement(P.a,{size:"sm"},s.a.createElement(D.a,{type:"text",placeholder:"Search for friends",onChange:function(t){return e.handleChange(t)}}),s.a.createElement(P.a.Append,null,s.a.createElement(g.a,{variant:"outline-secondary",onClick:function(t){return e.handleKeyPress(t)}},"Search")))),s.a.createElement(C.a,{className:'justify-content-end"'},s.a.createElement(C.a.Link,{onClick:this.handleSignOut},"Sign-Out"),s.a.createElement(M.a,{to:"/".concat(n||null)},s.a.createElement("img",{src:a.avatarUrl()?a.avatarUrl():"https://s3.amazonaws.com/onename/avatar-placeholder.png",alt:"",className:"nav-img"}))))))}}]),t}(n.Component),B=a(31),J=a(108),W=a.n(J),Y=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"no-res-container"},s.a.createElement("p",null,"Oopsie... ",s.a.createElement("br",null)," We can't find the blockstack id ",s.a.createElement("big",null,'"',this.props.username,'"'),"."))}}]),t}(n.Component),z=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"container-myprofile"},s.a.createElement("div",{className:"loader"}))}}]),t}(n.Component),_=a(109),q=a(69),H=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).isLocal=function(){return a.props.match.params.username===Object(L.loadUserData)().username},a.addFriend=function(e){e.preventDefault();var t=a.props.friends;t.push(a.state.username);Object(L.putFile)("friends.json",JSON.stringify(t),{encrypt:!1}).then(function(e){console.log("res ,",e),a.setState({following:!0})}),a.setState({following:!0})},a.unFriend=function(e){e.preventDefault();var t=a.props.friends,n=a.state.username;t=t.filter(function(e){return e!==n}),a.props.updateFriends(t);Object(L.putFile)("friends.json",JSON.stringify(t),{encrypt:!1}).then(function(e){console.log("res ,",e),a.setState({following:!1})})},a.logUserInfo=function(){console.log(Object(L.loadUserData)())},a.state={person:void 0,username:"",checked:!1,statuses:[],statusIndex:0,isLoading:!0,following:!1,postIds:[],posts:[],postIdAndName:{}},a.fetchData=a.fetchData.bind(Object(B.a)(Object(B.a)(a))),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"fetchData",value:function(){var e=this,t=this.props.match.params.username.indexOf(".id.blockstack")>-1?this.props.match.params.username:this.props.match.params.username+".id.blockstack";this.setState({isLoading:!0,username:t}),Object(L.lookupProfile)(t).then(function(t){e.setState({person:new L.Person(t)})}).catch(function(t){e.setState({person:!1})});var a,n={username:t,decrypt:!1},s={};Object(L.getFile)("postids.json",n).then(function(e){if((a=JSON.parse(e||"[]")).length>0)for(var n=0;n<a.length;n++)s["".concat(a[n])]=t}).catch(function(){console.log("oepsie, could not fetch data")}).finally(function(){e.setState({isLoading:!1,postIds:a,postIdAndName:s})}),this.props.friends.includes(t)?this.setState({following:!0}):this.setState({following:!1})}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentWillReceiveProps",value:function(){this.fetchData()}},{key:"render",value:function(){var e=this.state,t=e.person,a=e.username,n=e.isLoading,r={backgroundImage:'url("'.concat(W.a,'"')};return s.a.createElement("div",null,n&&s.a.createElement(z,null),!n&&t?s.a.createElement("div",{className:"container-myprofile"},s.a.createElement("div",{style:r,className:"container-desc-prof"},s.a.createElement(_.a,{person:t,username:a}),s.a.createElement("div",{className:"myprofile-options"},s.a.createElement(v.a,{className:"my-options"},s.a.createElement(b.a,{xs:3}),s.a.createElement(b.a,{xs:2},s.a.createElement("p",{className:"text-secondary"},"Posts: ",this.state.postIds.length)),s.a.createElement(b.a,{xs:2},this.state.following?s.a.createElement(g.a,{variant:"outline-danger",className:"",onClick:this.unFriend},"Unfollow"):s.a.createElement(g.a,{variant:"outline-success",className:"",onClick:this.addFriend},"Follow")),s.a.createElement(b.a,{xs:5})),s.a.createElement(v.a,null,s.a.createElement(b.a,{md:3}),s.a.createElement(b.a,{xs:12,md:8},s.a.createElement("hr",null)," "),s.a.createElement(b.a,{md:1})),s.a.createElement(v.a,null,s.a.createElement(b.a,{xs:12},s.a.createElement("p",{className:"text-secondary"},t.description()?t.description():"You have no bio."))))),s.a.createElement("div",{className:"profile-posts"},s.a.createElement(v.a,null,s.a.createElement(b.a,{xs:1,md:1,xl:2}),s.a.createElement(b.a,{sm:12,md:10,xl:8},this.state.isLoading&&s.a.createElement("span",null,"Loading..."),!this.state.isLoading&&this.state.postIds.length>0&&s.a.createElement(q.a,{array:!1,order:this.state.postIds,postIdAndName:this.state.postIdAndName,person:t,username:a}),0===this.state.postIds.length&&s.a.createElement("h1",null,"This user has no posts yet.")),s.a.createElement(b.a,{xs:1,md:1})))):s.a.createElement(Y,{username:a}))}}]),t}(n.Component),R=a(110),K=function e(t){if(1===t.length||0===t.length)return t;var a=t.length,n=Math.floor(a/2),s=t.slice(0,n),r=t.slice(n);return G(e(s),e(r))},G=function(e,t){for(var a=[],n=0,s=0;n<e.length&&s<t.length;)e[n]>t[s]?(a.push(e[n]),n++):(a.push(t[s]),s++);return a.concat(e.slice(n)).concat(t.slice(s))},X=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).fetchPostsFromFriends=function(){a.setState({isLoading:!0});var e=a.props.friends,t={},n=[];e.forEach(function(){var r=Object(i.a)(l.a.mark(function r(c,o){var i,u;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(L.lookupProfile)(c).then(function(e){return new L.Person(e)}).catch(function(e){console.log("could not resolve profile")});case 2:i=r.sent,u={username:c,decrypt:!1},Object(L.getFile)("postids.json",u).then(function(e){var a=JSON.parse(e||"[]");a.length>0&&a.forEach(function(e,a){Object(L.getFile)("post".concat(e,".json"),u).then(function(a){var r=JSON.parse(a);n.push(e),t[e]=s.a.createElement(R.a,{person:i,username:c,status:r,key:r.created_at})})})}).catch(function(e){console.log("fail")}).finally(function(){setTimeout(function(){o===e.length-1&&a.setState({allPosts:t,order:K(n),isLoading:!1,noPosts:0===t.length})},1e3)});case 5:case"end":return r.stop()}},r,this)}));return function(e,t){return r.apply(this,arguments)}}())},a.state={allPosts:[],isLoading:!1,order:[],noPosts:!1},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.fetchPostsFromFriends()}},{key:"render",value:function(){return s.a.createElement("div",{className:"feed-container"},s.a.createElement(v.a,null,s.a.createElement(b.a,{md:1,xl:2}),s.a.createElement(b.a,{sm:12,md:10,xl:8},this.state.isLoading&&s.a.createElement(z,null),this.state.noPosts&&!this.state.isLoading&&s.a.createElement("h1",null,"Oepsie, you have no posts in your timeline yet"),!this.state.noPosts&&!this.state.isLoading&&s.a.createElement(q.a,{array:!0,order:this.state.order,allPosts:this.state.allPosts})),s.a.createElement(b.a,{md:1,xl:2})))}}]),t}(n.Component),$=a(599),Q=a(600),V=(a(587),"https://s3.amazonaws.com/onename/avatar-placeholder.png"),Z=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).checkSignedInStatus=function(){return!!Object(L.isUserSignedIn)()||(Object(L.isSignInPending)()?(Object(L.handlePendingSignIn)().then(function(e){this.props.history.push("/")}),!1):void 0)},a.loadPerson=Object(i.a)(l.a.mark(function e(){var t,n,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(L.loadUserData)(),e.next=3,new L.Person(t.profile);case 3:return n=e.sent,a.loadFriends(),e.next=7,t.username;case 7:s=e.sent,a.setState({person:n,username:s}),a.props.history.push("/".concat(s));case 10:case"end":return e.stop()}},e,this)})),a.loadFriends=function(){Object(L.getFile)("friends.json",{decrypt:!1}).then(function(e){var t=JSON.parse(e||"[]");t.push(a.state.username),a.setState({friends:t})})},a.handleSignIn=function(e){e.preventDefault();var t=window.location.origin;Object(L.redirectToSignIn)(t,t+"/manifest.json",["store_write","publish_data"])},a.searchFor=function(e){a.props.history.push("/users/".concat(e))},a.updateFriends=function(e){a.setState({friends:e})};var n=a.checkSignedInStatus();return a.state={isSignedIn:n,person:{name:function(){return"Anonymous"},avatarUrl:function(){return V},description:function(){return"No description"}},username:null,friends:[]},n&&a.loadPerson(),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){Object(L.isSignInPending)()&&Object(L.handlePendingSignIn)().then(function(e){window.location=window.location.origin})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},this.state.isSignedIn?s.a.createElement("div",null,s.a.createElement(T,{searchFor:this.searchFor,person:this.state.person,username:this.state.username}),s.a.createElement($.a,null,s.a.createElement(Q.a,{path:"/users/:username",render:function(t){return s.a.createElement(H,Object.assign({updateFriends:e.updateFriends,friends:e.state.friends,person:e.state.person,username:e.state.username},t))}}),s.a.createElement(Q.a,{exact:!0,path:"/feed",render:function(t){return s.a.createElement(X,Object.assign({searchFor:e.searchFor,friends:e.state.friends,person:e.state.person,username:e.state.username},t))}}),s.a.createElement(Q.a,{path:"/:username",render:function(t){return s.a.createElement(f.a,Object.assign({searchFor:e.searchFor,friends:e.state.friends,person:e.state.person,username:e.state.username},t))}}),s.a.createElement(Q.a,{exact:!0,path:"/",render:function(t){return s.a.createElement(X,Object.assign({searchFor:e.searchFor,friends:e.state.friends,person:e.state.person,username:e.state.username},t))}}))):s.a.createElement(I,{handleSignIn:this.handleSignIn}))}}]),t}(n.Component),ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function te(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var ae=a(598);c.a.render(s.a.createElement(ae.a,null,s.a.createElement(Q.a,{path:"/",render:function(e){return s.a.createElement(Z,e)}})),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ee?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):te(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):te(e)})}}()},69:function(e,t,a){"use strict";a.d(t,"a",function(){return p});var n=a(275),s=a(16),r=a(17),c=a(19),o=a(18),l=a(20),i=a(0),u=a.n(i),m=a(110),d=a(11),p=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).loadMore=function(){if(a.props.array)return!1;for(var e=Object(n.a)({},a.state.posts),t=function(t){var n=a.props.order[t],s={username:a.props.postIdAndName[n],decrypt:!1};Object(d.getFile)("post".concat(n,".json"),s).then(function(e){var t=JSON.parse(e);return u.a.createElement(m.a,{person:a.props.person,username:a.props.username,status:t,key:t.created_at})}).then(function(t){e[n]=t}).then(function(){t===a.state.counter+1&&a.setState({posts:e,counter:t,loadPost:!1})}).catch(function(){a.setState({posts:e,counter:t-1,loadPost:!1})})},s=a.state.counter;s<a.state.counter+2;s++)t(s)},a.loadFeed=function(){},a.handleScroll=function(){if(a.props.order.length-1>a.state.counter&&!a.state.loadPost){var e=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight,n=document.documentElement.clientHeight||window.innerHeight;Math.ceil(e+n)>=t&&!a.props.array&&(a.loadMore(),a.setState({loadPost:!0}))}},a.state={posts:{},counter:0,loadPost:!1},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("scroll",this.handleScroll),window.addEventListener("load",function(){setTimeout(function(){e.loadMore(),e.setState({loadPost:!0})},300)})}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("scroll",this.handleOnScroll),window.removeEventListener("load",function(){setTimeout(function(){e.loadMore()},300)})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"infinite-list"},this.props.array&&this.props.order.map(function(t){return e.props.allPosts[t]}),!this.props.array&&this.props.order.map(function(t){return e.state.posts[t]}),this.state.loadPost&&u.a.createElement("div",{className:"feed-loader"}))}}]),t}(i.Component)}},[[276,2,1]]]);
//# sourceMappingURL=main.8090eb91.chunk.js.map